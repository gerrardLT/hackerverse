# IPFS æ¶æ„ä¿®æ­£è¯´æ˜

## ğŸš¨ é—®é¢˜å‘ç°

ç”¨æˆ·æ­£ç¡®æŒ‡å‡ºäº†æ¶æ„é—®é¢˜ï¼š**å‰ç«¯ä¸åº”è¯¥ç›´æ¥è°ƒç”¨Pinata**ï¼Œè€Œåº”è¯¥é€šè¿‡åç«¯APIè¿›è¡Œäº¤äº’ã€‚

## ğŸ”§ æ­£ç¡®çš„æ¶æ„

### **æ•°æ®æµç¨‹**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯   â”‚â”€â”€â”€â–¶â”‚  åç«¯API â”‚â”€â”€â”€â–¶â”‚ Pinata  â”‚â”€â”€â”€â–¶â”‚  IPFS   â”‚
â”‚         â”‚    â”‚          â”‚    â”‚         â”‚    â”‚         â”‚
â”‚ è¯»å–æ•°æ®â”‚â—€â”€â”€â”€â”‚ è¿”å›Hash â”‚â—€â”€â”€â”€â”‚ è¿”å›CID â”‚â—€â”€â”€â”€â”‚ å­˜å‚¨æ•°æ®â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚
     â”‚              â”‚
     â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ IPFSç½‘å…³â”‚    â”‚ æ•°æ®åº“   â”‚
â”‚ è¯»å–æ•°æ®â”‚    â”‚ å­˜å‚¨CID  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **èŒè´£åˆ†å·¥**

#### **å‰ç«¯èŒè´£**
- âœ… **è¯»å–æ•°æ®**: ä»IPFSç½‘å…³è·å–æ•°æ®
- âœ… **å‡†å¤‡æ•°æ®**: åˆ›å»ºå…ƒæ•°æ®å¯¹è±¡
- âœ… **ç½‘å…³ç®¡ç†**: å¤šç½‘å…³æ•…éšœåˆ‡æ¢
- âŒ **ä¸Šä¼ æ•°æ®**: ä¸ç›´æ¥è°ƒç”¨Pinata

#### **åç«¯èŒè´£**
- âœ… **ä¸Šä¼ æ•°æ®**: è°ƒç”¨Pinata APIä¸Šä¼ åˆ°IPFS
- âœ… **å¯†é’¥ç®¡ç†**: å®‰å…¨å­˜å‚¨Pinata APIå¯†é’¥
- âœ… **æ•°æ®éªŒè¯**: éªŒè¯ä¸Šä¼ ç»“æœ
- âœ… **è¿”å›Hash**: å°†IPFS Hashè¿”å›ç»™å‰ç«¯

## ğŸ”„ ä¿®æ­£åçš„å®ç°

### **å‰ç«¯IPFSæœåŠ¡** (`frontend/lib/ipfs.ts`)

```typescript
class IPFSService {
  // åªè´Ÿè´£æ•°æ®è·å–ï¼Œä¸è´Ÿè´£ä¸Šä¼ 
  async getJSON(hash: string): Promise<any> {
    // ä»å¤šä¸ªç½‘å…³è·å–æ•°æ®
  }
  
  async getFile(hash: string): Promise<any> {
    // ä»å¤šä¸ªç½‘å…³è·å–æ–‡ä»¶
  }
  
  // å…ƒæ•°æ®åˆ›å»ºï¼ˆå®é™…ä¸Šä¼ ç”±åç«¯å¤„ç†ï¼‰
  createProjectMetadata(project: any): any {
    return { /* å‡†å¤‡æ•°æ® */ }
  }
}
```

### **åç«¯API** (`backend/app/api/ipfs/upload/route.ts`)

```typescript
export async function POST(request: Request) {
  try {
    const data = await request.json()
    
    // è°ƒç”¨Pinataä¸Šä¼ 
    const hash = await IPFSService.uploadJSON(data)
    
    // å­˜å‚¨åˆ°æ•°æ®åº“
    await db.save({ ipfsHash: hash })
    
    return Response.json({ success: true, hash })
  } catch (error) {
    return Response.json({ success: false, error: error.message })
  }
}
```

### **å‰ç«¯ä¸Šä¼ æµç¨‹**

```typescript
// é”™è¯¯çš„æ–¹å¼ï¼ˆå·²ç§»é™¤ï¼‰
// const hash = await ipfsService.uploadJSON(data)

// æ­£ç¡®çš„æ–¹å¼
async function uploadData(data: any) {
  const response = await fetch('/api/ipfs/upload', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data)
  })
  
  const result = await response.json()
  if (result.success) {
    return result.hash // IPFS Hash
  } else {
    throw new Error(result.error)
  }
}
```

## ğŸ¯ ä¼˜åŠ¿

### **å®‰å…¨æ€§**
- âœ… APIå¯†é’¥åªåœ¨åç«¯å­˜å‚¨
- âœ… å‰ç«¯æ— æ³•ç›´æ¥è®¿é—®Pinata API
- âœ… ç»Ÿä¸€çš„æƒé™æ§åˆ¶

### **å¯ç»´æŠ¤æ€§**
- âœ… æ¸…æ™°çš„èŒè´£åˆ†ç¦»
- âœ… ç»Ÿä¸€çš„é”™è¯¯å¤„ç†
- âœ… ä¾¿äºç›‘æ§å’Œæ—¥å¿—

### **æ€§èƒ½**
- âœ… åç«¯å¯ä»¥ç¼“å­˜å’Œä¼˜åŒ–
- âœ… å‰ç«¯ä¸“æ³¨äºæ•°æ®å±•ç¤º
- âœ… å‡å°‘å‰ç«¯ä»£ç å¤æ‚åº¦

## ğŸ“Š æ•°æ®æµç¨‹ç¤ºä¾‹

### **ç”¨æˆ·æ³¨å†Œæµç¨‹**
1. å‰ç«¯æ”¶é›†ç”¨æˆ·æ•°æ®
2. å‰ç«¯è°ƒç”¨ `/api/auth/signup`
3. åç«¯åˆ›å»ºç”¨æˆ·èµ„æ–™å…ƒæ•°æ®
4. åç«¯è°ƒç”¨Pinataä¸Šä¼ åˆ°IPFS
5. åç«¯å­˜å‚¨ç”¨æˆ·ä¿¡æ¯å’ŒIPFS Hash
6. åç«¯è¿”å›æˆåŠŸå“åº”
7. å‰ç«¯æ˜¾ç¤ºæ³¨å†ŒæˆåŠŸ

### **æ•°æ®è¯»å–æµç¨‹**
1. å‰ç«¯éœ€è¦æ˜¾ç¤ºç”¨æˆ·èµ„æ–™
2. å‰ç«¯ä»æ•°æ®åº“è·å–IPFS Hash
3. å‰ç«¯é€šè¿‡ç½‘å…³è·å–IPFSæ•°æ®
4. å‰ç«¯è§£æå’Œæ˜¾ç¤ºæ•°æ®

## ğŸš¨ æ³¨æ„äº‹é¡¹

### **å‰ç«¯é…ç½®**
- åªéœ€è¦é…ç½®ç½‘å…³åŸŸåï¼ˆç”¨äºè¯»å–ï¼‰
- ä¸éœ€è¦APIå¯†é’¥
- ç¯å¢ƒå˜é‡ï¼š`NEXT_PUBLIC_PINATA_GATEWAY`

### **åç«¯é…ç½®**
- éœ€è¦å®Œæ•´çš„Pinataé…ç½®
- ç¯å¢ƒå˜é‡ï¼š`PINATA_JWT`, `PINATA_GATEWAY`
- è´Ÿè´£æ‰€æœ‰ä¸Šä¼ æ“ä½œ

## ğŸ‰ æ€»ç»“

ä¿®æ­£åçš„æ¶æ„æ›´åŠ ï¼š
- **å®‰å…¨**: APIå¯†é’¥ä¿æŠ¤
- **æ¸…æ™°**: èŒè´£åˆ†ç¦»æ˜ç¡®
- **å¯ç»´æŠ¤**: ä»£ç ç»“æ„åˆç†
- **å¯æ‰©å±•**: ä¾¿äºåŠŸèƒ½æ‰©å±•

æ„Ÿè°¢ç”¨æˆ·çš„æŒ‡æ­£ï¼è¿™ä¸ªæ¶æ„ä¿®æ­£ç¡®ä¿äº†é¡¹ç›®çš„å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚
