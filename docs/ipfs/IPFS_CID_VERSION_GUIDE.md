# IPFS CID ç‰ˆæœ¬ä½¿ç”¨æŒ‡å—

## ğŸ“‹ CID ç‰ˆæœ¬æ¦‚è¿°

### CIDv0 (ä¼ ç»Ÿæ ¼å¼)
- **å‰ç¼€**: `Qm`
- **é•¿åº¦**: 46ä¸ªå­—ç¬¦
- **æ ¼å¼**: `Qm[1-9A-HJ-NP-Za-km-z]{44}`
- **ç¤ºä¾‹**: `QmYwAPJzv5CZsnA625s3Xf2nemtYgPpHdWEz79ojWnPbdG`
- **ç‰¹ç‚¹**: 
  - å‘åå…¼å®¹æ€§å¥½
  - å¹¿æ³›æ”¯æŒ
  - è¾ƒçŸ­çš„æ ‡è¯†ç¬¦

### CIDv1 (ç°ä»£æ ¼å¼)
- **å‰ç¼€**: `bafy`
- **é•¿åº¦**: 59ä¸ªå­—ç¬¦
- **æ ¼å¼**: `bafy[1-9A-HJ-NP-Za-km-z]{55}`
- **ç¤ºä¾‹**: `bafybeigdyrzt5sfp7udm7hu76uh7y26nf3efuylqabf3oclgtqy55fbzdi`
- **ç‰¹ç‚¹**:
  - æ›´å®‰å…¨
  - æ›´å¥½çš„å¤šå“ˆå¸Œæ”¯æŒ
  - æœªæ¥æ ‡å‡†

## ğŸ”§ HackX é¡¹ç›®ä¸­çš„ CID ä½¿ç”¨

### å½“å‰å®ç°
æˆ‘ä»¬çš„é¡¹ç›®**åŒæ—¶æ”¯æŒ CIDv0 å’Œ CIDv1**ï¼Œç¡®ä¿æœ€å¤§çš„å…¼å®¹æ€§ã€‚

### Pinata æœåŠ¡
- **ä¸Šä¼ **: Pinata è‡ªåŠ¨ç”Ÿæˆ CIDv1
- **è·å–**: æ”¯æŒä¸¤ç§æ ¼å¼çš„æ•°æ®è·å–
- **ç½‘å…³**: æ‰€æœ‰ç½‘å…³éƒ½æ”¯æŒä¸¤ç§æ ¼å¼

### éªŒè¯é€»è¾‘
```typescript
// åç«¯éªŒè¯ (backend/lib/ipfs.ts)
static isValidHash(hash: string): boolean {
  // CIDv0: Qmå¼€å¤´ï¼Œ46ä¸ªå­—ç¬¦
  const cidv0Pattern = /^Qm[1-9A-HJ-NP-Za-km-z]{44}$/
  // CIDv1: bafyå¼€å¤´ï¼Œ59ä¸ªå­—ç¬¦
  const cidv1Pattern = /^bafy[1-9A-HJ-NP-Za-km-z]{55}$/
  
  return cidv0Pattern.test(hash) || cidv1Pattern.test(hash)
}

// å‰ç«¯éªŒè¯ (frontend/lib/ipfs.ts)
isValidHash(hash: string): boolean {
  const cidv0Pattern = /^Qm[1-9A-HJ-NP-Za-km-z]{44}$/
  const cidv1Pattern = /^bafy[1-9A-HJ-NP-Za-km-z]{55}$/
  const otherPattern = /^k2k4r8[a-z0-9]{50}$/
  
  return cidv0Pattern.test(hash) || cidv1Pattern.test(hash) || otherPattern.test(hash)
}
```

## ğŸ“Š æ•°æ®æµç¨‹ä¸­çš„ CID ä½¿ç”¨

### ä¸Šä¼ æµç¨‹
1. **ç”¨æˆ·æ“ä½œ** â†’ åç«¯API
2. **Pinataä¸Šä¼ ** â†’ è‡ªåŠ¨ç”Ÿæˆ CIDv1
3. **å­˜å‚¨CID** â†’ æ•°æ®åº“ä¿å­˜å®Œæ•´CID
4. **è¿”å›å“åº”** â†’ å‰ç«¯æ¥æ”¶CID

### è·å–æµç¨‹
1. **å‰ç«¯è¯·æ±‚** â†’ ä½¿ç”¨å­˜å‚¨çš„CID
2. **ç½‘å…³è®¿é—®** â†’ æ”¯æŒä¸¤ç§æ ¼å¼
3. **æ•°æ®è§£æ** â†’ éªŒè¯CIDæ ¼å¼
4. **è¿”å›æ•°æ®** â†’ ç”¨æˆ·ç•Œé¢æ˜¾ç¤º

## ğŸ¯ æœ€ä½³å®è·µ

### 1. å­˜å‚¨ç­–ç•¥
- **æ•°æ®åº“**: å­˜å‚¨å®Œæ•´çš„CIDå­—ç¬¦ä¸²
- **éªŒè¯**: ä¸Šä¼ å‰éªŒè¯CIDæ ¼å¼
- **å…¼å®¹æ€§**: æ”¯æŒä¸¤ç§æ ¼å¼çš„è¯»å–

### 2. ç½‘å…³è®¿é—®
- **ä¼˜å…ˆ**: Pinataä¸“ç”¨ç½‘å…³
- **å¤‡ç”¨**: å…¬å…±ç½‘å…³
- **æ ¼å¼**: è‡ªåŠ¨å¤„ç†CIDæ ¼å¼

### 3. é”™è¯¯å¤„ç†
- **æ ¼å¼é”™è¯¯**: æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
- **ç½‘å…³å¤±è´¥**: è‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨ç½‘å…³
- **æ•°æ®éªŒè¯**: ç¡®ä¿è·å–çš„æ•°æ®å®Œæ•´æ€§

## ğŸ” CID æ ¼å¼æ£€æµ‹

### æ£€æµ‹æ–¹æ³•
```typescript
function detectCIDVersion(cid: string): 'v0' | 'v1' | 'unknown' {
  if (/^Qm[1-9A-HJ-NP-Za-km-z]{44}$/.test(cid)) {
    return 'v0'
  }
  if (/^bafy[1-9A-HJ-NP-Za-km-z]{55}$/.test(cid)) {
    return 'v1'
  }
  return 'unknown'
}
```

### ä½¿ç”¨ç¤ºä¾‹
```typescript
const cid = 'bafybeigdyrzt5sfp7udm7hu76uh7y26nf3efuylqabf3oclgtqy55fbzdi'
const version = detectCIDVersion(cid) // è¿”å› 'v1'
```

## ğŸ“ˆ æ€§èƒ½è€ƒè™‘

### CIDv0 ä¼˜åŠ¿
- æ›´çŸ­çš„æ ‡è¯†ç¬¦
- æ›´å¿«çš„å­—ç¬¦ä¸²å¤„ç†
- æ›´å°‘çš„å­˜å‚¨ç©ºé—´

### CIDv1 ä¼˜åŠ¿
- æ›´å¥½çš„å®‰å…¨æ€§
- å¤šå“ˆå¸Œæ”¯æŒ
- æœªæ¥å…¼å®¹æ€§

### æ¨èç­–ç•¥
- **æ–°é¡¹ç›®**: ä¼˜å…ˆä½¿ç”¨ CIDv1
- **ç°æœ‰é¡¹ç›®**: ä¿æŒå‘åå…¼å®¹
- **æ··åˆç¯å¢ƒ**: æ”¯æŒä¸¤ç§æ ¼å¼

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. **æ ¼å¼éªŒè¯**: å§‹ç»ˆéªŒè¯CIDæ ¼å¼
2. **ç½‘å…³å…¼å®¹**: ç¡®ä¿ç½‘å…³æ”¯æŒç›®æ ‡æ ¼å¼
3. **é”™è¯¯å¤„ç†**: æä¾›å‹å¥½çš„é”™è¯¯ä¿¡æ¯
4. **æ–‡æ¡£è®°å½•**: è®°å½•ä½¿ç”¨çš„CIDæ ¼å¼

## ğŸ“ æ€»ç»“

HackX é¡¹ç›®é‡‡ç”¨**åŒé‡å…¼å®¹ç­–ç•¥**ï¼š
- âœ… æ”¯æŒ CIDv0 (ä¼ ç»Ÿæ ¼å¼)
- âœ… æ”¯æŒ CIDv1 (ç°ä»£æ ¼å¼)
- âœ… è‡ªåŠ¨æ ¼å¼æ£€æµ‹
- âœ… å¤šç½‘å…³å†—ä½™è®¿é—®
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†

è¿™ç¡®ä¿äº†æœ€å¤§çš„å…¼å®¹æ€§å’Œæœªæ¥çš„å¯æ‰©å±•æ€§ã€‚
